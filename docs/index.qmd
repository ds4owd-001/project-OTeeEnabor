---
title-block-banner: true
title: "Dive Into South African Police Service Crime Stats:2022-2023"
date: 2024-02-13
date-format: "YYYY-MM-D"
author: 
  - name: "Oselu Enabor"
    orcid: 0000-0003-3813-2474
    email: oenabor@gmail.com
abstract: Crime trends in South Africa has been on the increase since 1996 with major cities following the national trend. The increase in population, unequal wealth distribution, rising unemployment rates and erosion of public trust in the government due to corruption and malfeasance has not assisted in curbing the levels of crime. Crime statistics in the country are published by the South African Police Service, who are responsible for enforcing the laws and maintaining peace and order in the country. These statistics are published in collaboration with Statistics South Africa, the national statistical service of the nation. In this project, we analyse the crime trend in the country between 2013 and 2023.
license: "CC BY"
format: 
  html:
    toc: true
    number-sections: true
    fig-responsive: true
    fig-width: 8
    fig-height: 6
    code-fold: true
execute: 
  echo: true
  warning: false
bibliography: references.bib
editor: visual
editor_options:
  chunk_output_type: console
---

![](img/den-harrson-C14EEtqVsNA-unsplash.jpg)

# Introduction: Crime situation in South Africa

South Africa has one of the highest-crime rate in the world - which includes high rates for crimes such as assaults, rape, murder, and other violent crimes. The high crime rate has been attributed to factors such as inadequate education, unemployment, poverty, and unequal distribution of resources [@akinola2023youth; @bhorat2017socio; @brown2001determinants]. Violent crimes such as rape and murder are on the increase compared to other crimes in the country [@glaser2008violent]. Crime rate has a negative effect on foreign investments and reduces the faith in the government and institutions tasked with public safety [@brown2017effect].

## Project description

The [**South African Police Service (SAPS)**](https://www.saps.gov.za/) is the national police force of the **Republic of South Africa**. There are **1154 police stations** in the country which are classified under provincial borders, with a provincial commissioner appointed for each of the **9 provinces** in South Africa. The SAPS has **117950 officers** who are responsible for the maintenance of public safety of 62 million South Africans. The SAPS in collaboration with [**Statistics South Africa (Stats SA)**](https://www.statssa.gov.za/), generate crime statistics quarterly and annually. The statistics are in line with international best practices and are used to inform the policy development planning in the criminal justice systems.

## Objectives

The objectives of this data analysis project is as follows:

-   View the crime trends in the country

-   See which crimes are most common in each province

-   Give commentary on which areas need more police reinforcement based

![Members of the South African Police Service (SAPS).](https://mg.co.za/wp-content/uploads/2022/11/SAPS1-1024x683.jpg){width="427"}

# Methodology

**SAPS Crime Data**

According to the [SAPS website](https://www.saps.gov.za/services/crimestats.php), crimes reported are recorded as they are received (from either the victims, witnesses or third parties) by the police or when they are detected by the police, irrespective of when the crime(s) were committed or who committed them. Crime statistics are created from recording process where crime codes are allocated to a reported crime type. Police stations then aggregate the codes in order for the province and the national to synchronize computation and distribution of reports. The crime statics are focused on the **21 priority crimes** grouped into two categories:

1.  **17 community-reported serious crimes**

    -   contact

    -   contact-related

    -   property-related

    -   other serious crimes

2.  **Crimes that are detected as a result of police action.**

**World Bank Datasets**

The following were collected from [World Bank Data](https://data.worldbank.org/) and filtered to get South African records:

-   Gross Domestic Product (GDP) per capita

-   Unemployment (%total labour force)

-   Population

The methodology used to accomplish the project objectives is organised as follows. Firstly, the R libraries used are imported followed by the definition of custom-functions used to simply the analysis task . The raw data sets are imported and processed to make them analysis ready. An overview of South Africa is presented. This includes chosen statistics from the World Bank, and an overview of the make up of the country. The analysis of the processed crime data will start at the **national** level, then progress to the **provincial** level, and conclude at the **station** level within each province.

## Install libraries

```{r}
#| eval: false
install.packages(ggplot2)
install.packages(dplyr)
install.packages(tidyverse)
install.packages(janitor)
install.packages(here)
install.packages(gt)
install.packages(gtsummary)
install.packages(knitr)
install.packages(DT)
install.packages(maps)
install.packages(sf)
install.packages(leaflet)
```

## Import libraries

```{r}
# load necessary libraries
library(ggplot2)
library(dplyr)
library(tidyverse)
library(janitor)
library(here)
library(gt)
library(gtsummary)
library(knitr)
library(DT)
library(maps)
library(sf)
library(leaflet)
```

## Functions

**filter_df**: This function is used to filter the main crime dataframe by each category of crimes. The function takes in 2 inputs:

-   *`df`:* an input dataframe

-   *`crime_list`*: a list of crimes used to filter the dataframe

The function returns a dataframe filtered by the *`crime_list`*.

```{r}
filter_df <- function(df, crime_list){
  df |> 
    filter(crime_category%in% crime_list) |> 
    group_by(year, crime_category, crime_count) |> 
    summarise(
      
    ) |> 
    mutate(
      year = str_remove(year,"x"),
      year = str_replace(year,"_","/")
    )
    
}
```

**filter_provincial**: This function is an extension of the previous function. The only difference is that the **input dataframe has been filtered for provincial crime statistics**.

```{r}
filter_df_provincial <- function(df, crime_list){
  df |> 
    filter(crime_category%in% crime_list) |> 
    group_by(year, station, crime_category, crime_count) |> 
    summarise(
      
    ) |> 
    mutate(
      year = str_remove(year,"x"),
      year = str_replace(year,"_","/")
    )
    
}
```

**provincial_facet**: This function creates a **facet_wrap plot** based on the 9 provinces in the country. The function is used to **view the trend of each type of or grouping of crime(s)**. The function has two inputs:

-   *`df`*: an input dataframe

-   *`plot_title`*: plot title for the facet_wrap plot.

```{r}
provincial_facet <- function(df,plot_title) {
  ggplot(
    df,
    aes(
      x = year,
      y = crime_count,
      group = crime_category,
      color = crime_category
    )
  ) +
    geom_line() +
    geom_point()+
    labs(
      title = plot_title,
      x = "Year",
      y = "Number of observations"
    )+ 
    theme(axis.text.x = element_text(hjust=1, size=6,angle=45),
      legend.position = "bottom",
          legend.key.size = unit(0.05,"cm")) +
    facet_wrap(~station)
}
```

**Station:** This function is used to generate the **top N stations** that have the highest number of reported cases for a specific crime.

-   `df`: dataframe of South African crimes

-   `crime_filter`: filters the dataframe for the crime of interest

-   `crime_title`: title for the output table

-   `rank`: get the top `rank` results in the table

```{r}
station_crime_rank <- function(df,crime_filter,crime_title, rank){
  crime_station_df <- df |> 
    filter(crime_category %in% crime_filter) |> 
    group_by(
      station, province, district
    ) |> 
    summarise(
      crime_count = sum(crime_count)
    ) |> 
    arrange(
      desc(crime_count)
      ) |> 
    ungroup()
  
  crime_station_df <- crime_station_df |>
    mutate(
      Rank = row_number(),
      .before=1
    )
  crime_station_df_rank <- crime_station_df[1:rank, ] |> 
    gt() |> 
    tab_header(
      title = sprintf("Top %s Stations for %s", rank, crime_title),
      subtitle = "Data from 2013 to 2023"
    ) |> 
    cols_label(
      station="Station",
      province="Province",
      district="District"
    )

  return(crime_station_df_rank)
}
```

## Import Datasets

Import the SAPS Annual Statistics raw csv file.

```{r}
# read in the SAPS Crime dataset
df_crime_sa = read_csv(here::here("data/raw/2022_2023 _annual_stats_raw.csv"))
#read_csv("../data/raw/2022_2023 _annual_stats_raw.csv")
# show first five observations
head(df_crime_sa)
```

Import the csv file containing general information (population, land size, density) about South African provinces.\`

```{r}
# read in SA_info_dataset
za_df = read_csv(here::here("data/raw/South_Africa_provinces.csv"))
# show first five observations
head(za_df)
```

Import the following World Bank datasets:

-   Gross domestic product per capita (1960 - 2023)

-   Unemployment (% of total labour force) (1960 - 2023)

-   Population (1960 - 2023)

```{r}
# import World Bank GDP Per Capita
wb_gdp = read_csv(here::here("data/raw/World_bank_GDP_Per_Capita.csv"))

# show first 5 observations
head(wb_gdp)


```

```{r}
# import unemployment (% total labor force)
wb_uem = read_csv(here::here("data/raw/World_bank_unemployment_total_work_force.csv"))

# show first 5 observations
head(wb_uem)

```

```{r}
# import population stats
wb_pop = read_csv(here::here("data/raw/World_Bank_Population_total.csv"))

# show first 5 observations
head(wb_pop)
```

```{r}

```

## Data Processing

**SAPS Raw**

```{r}
# use the clean_names function to convert variable names to snake_case convention.
df_crime_sa_clean <- df_crime_sa |> 
  clean_names()

```

```{r}
# select relevant columns and remove columns with no information (NA in each row)

df_crime_sa_clean <- df_crime_sa_clean |>
  select(crime_category_national_contribution_placement:count_offence_group)
# further cleaning of empty columns
df_crime_sa_clean <- subset(df_crime_sa_clean, select = -c(crime_category_national_contribution_placement,crime_category_provincial_contribution_placement, station_crime_category,code,national_contribution_placement,national_count_diff_placement,provincial_contribution_placement, provincial_count_diff_placement, count_direction))
```

```{r}
# show first 5 observations
head(df_crime_sa_clean)
```

**National**

```{r}
# filter the crime dataset for observations where the comp_level is equal to National
df_crime_sa_national <- df_crime_sa_clean |>
  filter(comp_level=="National") |> 
  # select(crime_category:count_offence_group) |> 
  # select(!provincial_contribution_placement) |> 
  pivot_longer(
    cols = x2013_2014:x2022_2023,
    names_to = "year",
    values_to = "crime_count"
  )

# show first 5 observations
head(df_crime_sa_national)
```

**Provincial**

```{r}
#| eval: true
# filter the crime dataset for observations where the comp_level is equal to provincial
df_crime_sa_provincial <- df_crime_sa_clean |>
  filter(comp_level=="Province") |> 
  # select(crime_category:count_offence_group) |> 
  # select(!provincial_contribution_placement) |> 
  pivot_longer(
    cols = x2013_2014:x2022_2023,
    names_to = "year",
    values_to = "crime_count"
  )

# show first 5 observations
head(df_crime_sa_provincial)
```

**Station**

```{r}
#| eval: true
# filter the crime dataset for observations where the comp_level is equal to station
df_crime_sa_station <- df_crime_sa_clean |> 
  filter(comp_level=="Station") |> 
  pivot_longer(
    cols = x2013_2014:x2022_2023,
    names_to = "year",
    values_to = "crime_count"
  )

# show first 5 observations
head(df_crime_sa_station)
```

**World Bank Datasets**

The data sets are all in a wide format, the preprocessing done will be to transform them to a long format and convert the values in the *year* column to numbers.

```{r}
# GDP per capita
za_gdp <- wb_gdp |> 
  filter(`Country Code` == "ZAF") |> 
  pivot_longer(
    cols = `1960`:`2022`,
    names_to = "year",
    values_to = "gdp_per_capita"
  ) |> 
  mutate(
    year = parse_number(year)
  )
  
```

```{r}
# unemployment (%total labour force)
za_uem <- wb_uem |> 
  filter(`Country Code`=="ZAF") |> 
  pivot_longer(
    cols = `1960`:`2022`,
    names_to = "year",
    values_to = "unemployment",
    values_drop_na = TRUE
  ) |> 
  mutate(
    year=parse_number(year)
  )
```

```{r}
# population stats
za_pop <- wb_pop |> 
  filter(`Country Code` == "ZAF") |> 
  pivot_longer(
    cols= `1960`:`2022`,
    names_to = "year",
    values_to = "population",
    values_drop_na = TRUE
  ) |> 
  mutate(
    year=parse_number(year)
  )
```

## Save processed files

**SAPS Clean**

```{r}
## save the df_crime_sa_clean to processed folder
write_csv(df_crime_sa_clean,here::here("data/processed/df_crime_clean.csv"))
```

**SAPS National**

```{r}
# save the df_crime_sa_national to processed folder
# write_csv(df_crime_sa_national,  here::here("data/processed/df_crime_sa_national.csv"))

```

**SAPS Provincial**

```{r}
# save the df_crime_sa_provincial
# write_csv(df_crime_sa_provincial, here::here("data/processed/df_crime_sa_provincial.csv"))
```

**SAPS Station**

```{r}
# save the df_crime_sa_station
# write_csv(df_crime_sa_station, here::here("data/processed/df_crime_sa_station.csv"))
```

**World Bank Datasets**

```{r}
# save the za_gdp to processed folder
write_csv(za_gdp,here::here("data/processed/ZAF_GDP_Per_Capita_19602022.csv"))
```

```{r}
# save the za_uem to the processed folder
write_csv(za_uem, here::here("data/processed/ZAF_UEM_19602022.csv"))
```

```{r}
# save the za_pop to the processed folder
write_csv(za_pop, here::here("data/processed/ZAF_POP_19602022.csv"))
```

```{r}

```

```{r}



```

## Overview of South Africa

In this section, an overview of South Africa is presented - it serves as a pre-context to the crime statistics that will follow. First, the population density for each province is presented, and then we present several economic factors from the **World Bank.**

**Plot South African population growth**

```{r}
#| eval: true
#| label: fig-ZAF_Pop
#| fig-cap: "South African population growth between 1960 and 2023."

# ZA population
ggplot(za_pop,
       aes(
         x=year,
         y=population
       ))+
  geom_point()+
  geom_line()+
  geom_smooth(method = "lm")+
  ggtitle("Population growth of ZAF between 1960 - 2022")
  
```

**Plot South African GDP per capita growth**

```{r}
#| eval: true
#| label: fig-ZAF_GDP_pcap
#| fig-cap: "South African GDP per capita between 1960 and 2023."

ggplot(za_gdp,
       aes(
         x=year,
         y=gdp_per_capita
       ))+
  geom_point()+
  geom_line()+
  geom_smooth(method = "lm")+
  labs (
    title = "South Africa GDP per capita between 1960 and 2023",
    x = "Year",
    y = "GDP per capita") +
  theme(legend.position = "bottom",
        legend.key.size = unit(0.15,"cm"))

```

**Plot South African unemployment growth**

```{r}
#| eval: true
#| label: fig-ZAF_uem
#| fig-cap: "South African unemployment (%total labour force) between 1992 and 2023."

ggplot(za_uem,
       aes(
         x=year,
         y=unemployment
       ))+
  geom_point()+
  geom_line()+
  geom_smooth(method = "lm")+
  labs (
    title = "South Africa Unemployment (%total labour force) between 1992 and 2023",
    x = "Year",
    y = "Unemployment (%total labour force") +
  theme(legend.position = "bottom",
        legend.key.size = unit(0.15,"cm"))
```

### Provincial Composition of Crimes in the Country

In the previous section, we looked at how population, unemployment and GDP has changed throughout the years in South Africa. The reason was to provide some context to some of the crime statistics we shall see later on. We do not make any inferences as to the cause of the state of crimes just merely to see correlations between population growth, unemployment, and wealth production and state of crime in the country. South Africa has nine provinces are **the Eastern Cape, the Free State, Gauteng, KwaZulu-Natal, Limpopo, Mpumalanga, the Northern Cape, North West, and the Western Cape.**

![The map of South Africa's nine provinces. ([source](https://southafrica-info.com/land/nine-provinces-south-africa/))](img/Map_South_Africa_nine_provinces.jpg)

There is a vast size difference between the provinces, from the small and populated economic hub of **Gauteng** to the large and empty **North West**.

![The land size of each South African province. ([source](https://southafrica-info.com/land/nine-provinces-south-africa/))](img/South_Africa_provinces_by_land_area.png)

```{r}
#| eval: true

# transform data to sf object
za_sf = st_as_sf(za_df, coords  = c("long", "lat"))
ggplot(za_sf) +
  geom_sf(aes(col=density,
              size=population)
          )
# ggplot(za_df,
#        aes(x=population,
#            y=area,
#            size = density,
#            color=province) 
#        ) +
#   geom_point(alpha=0.7)+   
#   scale_size(range =c(.1,24),
#              name = "Population density")
```

Gauteng is the most densely populated province with the smallest land size and largest population of all the provinces. It is considered the economic hub of the country with a high rate of migration for better economic opportunities. The two major cities are Pretoria, the executive capital of the country, and Johannesburg, the financial hub. In 2016, Gauteng contributed **33.8%** of South Africa's gross domestic product and around **5%** of the GDP of Africa [@alexander_2023]. KwaZulu-Natal follows is the second most densely populated province, it has the biggest port in Durban, and contributed to **16%** of the GDP in 2016. Western Cape, is the third major province in terms of density and economic contribution to South Africa. These three provinces are reported to contribute around two-thirds to the total economy of South Africa.

# Results

The SAPS releases an annual crime report based on crime statistics, in which they focus on 21 priority crimes which are grouped into two main categories:

-   17 community-reported serious crimes

-   Crimes detected as a result of police action

## National Crime Trend

In this section, we will look at the crime trends on a **national level across selected crime categories over a 10 year period**. The dataset will be filtered for observations were the `comp_level` is **national.**

```{r}

```

### Contact Crimes (Crimes Against The Person)

Contact crimes involves crimes where victims are targets of violence or cases where victims are near property that are target by criminals and are subjected to violence or the threats of violence.

The crimes included in this grouping are: *Murder, Sexual offences, Attempted murder, Assault with the intention to inflict grievous bodily harm, Common assault, Common robbery, and Robbery with aggravating circumstances*.

Two of the crime groupings can be further subdivided into other crimes:

1.  Sexual Offences

    -   Rape

    -   Sexual Assault

    -   Attempted sexual offences

    -   Contact sexual assault

2.  Robbery with aggravating circumstances

    -   Carjacking Robbery at Non-residential premises

    -   Robbery at residential premises

    -   Robbery of cash in transit

    -   Truck Hijacking

```{r}
#| eval: true
# create contact_crimes list
contact_crimes_list <- c("Murder", "Sexual offences", "Attempted murder", "Assault with the intent to inflict grievous bodily harm", "Common assault", "Common robbery", "Robbery with aggravating circumstances")

# create contact crimes dataframe
contact_crimes_national <- filter_df(df_crime_sa_national, contact_crimes_list)
```

```{r}
#| eval: true
#| label: fig-contact_crime_national
#| fig-cap: "National contact crime trend between 2013 and 2023."
#| fig-alt: "A line plot of national contact crime trend in South Africa between 2013 and 2023."
ggplot(data = contact_crimes_national,
       aes(
         x = year,
         y = crime_count,
         group = crime_category,
         color = crime_category
       ))+
  geom_line()+
  labs (
    title = "National Contact Crime between 2013 and 2023",
    x = "Year",
    y = "Number of Observations",
    colour="Crime Category"

  ) +
  geom_label(aes(
    label = crime_count
    #,colour = crime_category
  ),
  label.size = 0.1) +
  # geom_text(check_overlap = TRUE) +
  theme(legend.position = "bottom")#legend.key.size = unit(0.15,"cm"))
```

```{r}
#| eval: true
```

```{r}
#| eval: true
```

```{r}
#| eval: false
# contact_crimes_national_wide <- contact_crimes_national |> 
#   pivot_wider(
#     names_from = year,
#     values_from = crime_count
#   )
# 
# contact_crimes_national_wide |> 
#   gt()
```

According to the stats and as presented in @fig-contact_crime_national, **common assault**, **assault** **with the intent to inflict grievous bodily harm**, and **robbery with aggravating circumstances** have been the most frequent contact crimes in South Africa in the past 10 years.

#### Sexual Offences

We shall look at the occurrence of sexual offences in the country over the past 10 years.

```{r}
#| eval: true
# create a list of offences that compose of sexual offences
sexual_offences_list <- c("Rape","Sexual assault","Attempted sexual offences","Contact sexual offences")

# filter out these offences from the national crime data frame
sexual_offences_national <- filter_df(df_crime_sa_national, sexual_offences_list)
```

```{r}
#| eval: true
#| label: fig-sexual_offences_national
#| fig-cap: "National sexual offences crime trend between 2013 and 2023."
#| fig-alt: "A line plot on a polar axis"
ggplot(data = sexual_offences_national,
       aes(
         x = year,
         y = crime_count,
         group = crime_category,
         color = crime_category
       ))+
  geom_line()+
  labs (
    title = "National Sexual Offences between 2013 and 2023",
    x = "Year",
    y = "Number of Observations"

  ) +
  geom_label(aes(
    label = crime_count,
    colour = crime_category
  ),
  label.size = 0.1) +
  theme(legend.position = "bottom",
        legend.key.size = unit(0.15,"cm"))
```

In @fig-sexual_offences_national, **rape** has consistently been the most frequent sexual offence in the past 10 years. The number of rape incidents has been 5 times greater than the other offences combined during this 10 year period. South Africa is among the countries with the highest rape cases in the world - [higher than countries at war](https://worldpopulationreview.com/country-rankings/rape-statistics-by-country). There were 42780 cases reported in 2022/2023, which equates to 177 incidents per day. Rape is a systemic and endemic problem in South Africa.

#### Aggravated Robbery

```{r}
#| eval: true
#| label: fig-robbery_aggrevated_national
#| fig-cap: "National Aggrebated Robbery trend between 2013 and 2023."
#| fig-alt: "A line plot on a polar axis"
# create a list of some of the subcategories of aggravated robbery
robbery_agg_list <- c("Carjacking","Robbery at residential premises","Robbery at non-residential premises" )

# use the list to filter national crime dataframe
robbery_agg_national <- filter_df(df_crime_sa_national, robbery_agg_list)

ggplot(data = robbery_agg_national,
       aes(
         x = year,
         y = crime_count,
         group = crime_category,
         color = crime_category
       ))+
  geom_line()+
  labs (
    title = "National Aggrevated Robbery between 2013 and 2023",
    x = "Year",
    y = "Number of Observations"

  ) +
  geom_label(aes(
    label = crime_count,
    colour = crime_category
  ),
  label.size = 0.1) +
  theme(legend.position = "bottom",
        legend.key.size = unit(0.15,"cm"))
```

Figure @fig-robbery_aggrevated_national shows that crimes in the aggravated robbery category have all increased during this 10 year period. *Robbery at residential premises* has topped the list out of these three crimes. However, *carjacking* has steadily increased in this time period and based on the trend, is expected to surpass *robbery at residential premises*.

### Contact-related Crimes

Contact-related crimes consist of *Arson* and *Malicious damage to property*. These crimes have a close relationship and also involve damage to or destruction of another person's property (usually as a means of punishment) or for the purpose of fraudulent insurance claims.

```{r}
#| eval: true
#| label: fig-contact_related_national
#| fig-cap: "National trend of contact-related crimes between 2013 and 2023."
#| fig-alt: "A line plot on a polar axis"
# create a contact related list crimes
contact_related_list <- c("Arson", "Malicious damage to property")

contact_related_national <- filter_df(df_crime_sa_national, contact_related_list)

ggplot(data = contact_related_national,
       aes(
         x = year,
         y = crime_count,
         group = crime_category,
         color = crime_category
       ))+
  geom_line()+
  labs (
    title = "National Contact-related crimes between 2013 and 2023",
    x = "Year",
    y = "Number of Observations"

  ) +
  geom_label(aes(
    label = crime_count,
    colour = crime_category
  ),
  label.size = 0.1) +
  theme(legend.position = "bottom",
        legend.key.size = unit(0.15,"cm"))
```

Figure @fig-contact_related_national shows that *malicious damage to property* has been the more dominant crime in this category during this time period. The number of cases started to drop in 2015/2016 but we see a sharp rise in 2020/2021 taking it back to 2015/2016 levels.

### Property-related crime

This refers crimes refers to the hostile take over of property by criminal elements without permission. These crimes includes the *burglary of both residential and non-residential properties, theft of motor vehicles and motorcycles, theft out of or from motor vehicles and livestock theft*.

```{r}
#| eval: true
#| label: fig-property_related_national
#| fig-cap: "National trend of property-related crimes between 2013 and 2023."
#| fig-alt: "A line plot on a polar axis"
property_related_crimes <- c("Burglary at non-residential premises", "Burglary at residential premises","Theft of motor vehicle and motorcycle","Theft of motor vehicle and motorcycle","Theft out of or from motor vehicle","Stock-theft")

# property related crimes
property_related_national <- filter_df(df_crime_sa_national, property_related_crimes)
# plot
ggplot(data = property_related_national,
       aes(
         x = year,
         y = crime_count,
         group = crime_category,
         color = crime_category
       ))+
  geom_line()+
  labs (
    title = "National Property-related crimes between 2013 and 2023",
    x = "Year",
    y = "Number of Observations"

  ) +
  geom_label(aes(
    label = crime_count,
    colour = crime_category
  ),
  label.size = 0.1) +
  theme(legend.position = "bottom",
        legend.key.size = unit(0.15,"cm"))
```

In Figure @fig-property_related_national, we see that *burglary at residential premises* has been the most common **property-related crime** between 2013 and 2023. Fortunately, we can see that the general trend has been a decrease in reported cases since 2013. Interestingly, we see a drastic drop (**22%**) in reported cases between 2019/2020 to 2020/2021. It would be interesting to investigate the effects of [COVID-19 *Hard Lockdown*](https://www.gov.za/covid-19/about/about-alert-system) on this reduction. *Theft out of or from motor vehicles* is the 2nd most common crime in this category and interestingly enough - I was a victim of a [car jamming](https://weloveit.africa/how-car-jamming-works/) incident in 2021/2022.

### Other Serious Crimes

These are serious crimes which have not been included in the categories above.

-   All Theft not mentioned elsewhere

-   Commercial crime

-   Shoplifting

```{r}
#| eval: true
#| label: fig-other_serious_crimes_national
#| fig-cap: "National trend of other serious crimes trend between 2013 and 2023."
#| fig-alt: "A line plot on a polar axis"
# create a list of the other serious crimes
serious_crimes_list <- c("All theft not mentioned elsewhere", "Commercial crime", "Shoplifting")

# create a dataframe for other serious crimes
serious_crimes_national <- filter_df(df_crime_sa_national, serious_crimes_list)

# plot the national trend of national serious crimes
ggplot(data = serious_crimes_national,
       aes(
         x = year,
         y = crime_count,
         group = crime_category,
         color = crime_category
       ))+
  geom_line()+
  labs (
    title = "National Other Serious crimes between 2013 and 2023",
    x = "Year",
    y = "Number of Observations"

  ) +
  geom_label(aes(
    label = crime_count,
    colour = crime_category
  ),
  label.size = 0.1) +
  theme(legend.position = "bottom",
        legend.key.size = unit(0.15,"cm"))
```

Theft is the most frequent crime in the **other serious crimes** category (Figure @fig-other_serious_crimes_national).

### Crimes Detected as a Result of Police Action

These are crimes mostly which are not reported to police, and are mostly dependent on the deployment of law enforcement and intelligence personnel. These crimes are recorded after the arrest of suspects connected to the following crimes.

-   Illegal possession of firearms and ammunition

-   Drug-related crimes

-   Driving under the influence of alcohol and/or drugs

-   Sexual offences detected as a result of police action

```{r}
#| eval: true
#| label: fig-police_detected_crimes_national
#| fig-cap: "National trend of crimes detected as a result of police action between 2013 and 2023."
#| fig-alt: "A line plot on a polar axis"
# create a list of the crimes detected as a result of police action
police_detected_list <- c("Illegal possession of firearms and ammunition", "Drug-related crime", "Driving under the influence of alcohol or drugs", "Sexual offences detected as a result of police action")

# create a dataframe for crimes detected as a result of police action
police_detected_crimes_national <- filter_df(df_crime_sa_national, police_detected_list)

# plot the national trend of crimes detected as a result of police action
ggplot(data = police_detected_crimes_national,
       aes(
         x = year,
         y = crime_count,
         group = crime_category,
         color = crime_category
       ))+
  geom_line()+
  labs (
    title = "National trend of crimes detected as a result of police action between 2013 and 2023",
    x = "Year",
    y = "Number of Observations"

  ) +
  geom_label(aes(
    label = crime_count,
    colour = crime_category
  ),
  label.size = 0.1) +
  theme(legend.position = "bottom",
        legend.key.size = unit(0.15,"cm"))
```

Figure @fig-police_detected_crimes_national shows the number of cases detected as a result of SAPS deployment. Therefore, making sense of this data visualization is interesting as increases and decreases can not be interpreted in the same as the previous figures. A **decrease** can be viewed as a negative because this means SAPS deployment and an **increase** can be viewed as more effective SAPS deployment.

```{r}

```

## Provincial Crime Trend

In this section, we will look at the crime trends on a **provincial level across selected crime categories over a 10 year period**. The dataset will be filtered for observations were the `comp_level` is **Province.** This section looks at how each of the **9 provinces contribute** to the national numbers.

### Contact Crimes

```{r}
#| eval: true
#| label: fig-contact-crimes-provincial
#| fig-cap: The trend of contact crimes in each province between 2013 and 2023.

# create contact crimes dataframe
contact_crimes_provincial <- filter_df_provincial(df_crime_sa_provincial, contact_crimes_list)
# create contact crimes facet plot
provincial_facet(contact_crimes_provincial, "Contact crime trend between 2013 and 2023 by Province")
```

In Figure @fig-contact-crimes-provincial, we see that the three most densely populated provinces have the higher number of cases for *robbery with aggravating circumstances, assault with intent to inflict grievous bodily harm, and common assault.* In Free State, Limpopo, Mpumalanga, North West, and Northern Cape, contact crime trend has stayed relatively constant during this period of interest. However, the trend of *assault with the intention to inflict grievous bodily harm* in Eastern Cape matches that of the big three provinces mentioned first above.

```         
```

#### Sexual Offences

```{r}
#| eval: true
#| label: fig-sexual-offences-crimes-provincial
#| fig-cap: The trend of sexual offences crimes in each province between 2013 and 2023.
# create sexual offences dataframe
sexual_offences_provincial <- filter_df_provincial(df_crime_sa_provincial, sexual_offences_list)
# create sexual offences facet plot
provincial_facet(sexual_offences_provincial, "Sexual Offences Trend between 2013 and 2023 by Province")

```

Figure @fig-sexual-offences-crimes-provincial, highlights South Africa's challenge with **rape**. **Rape** has the highest rates during this time period in all provinces. In each province, we see a drop in this crime between *2019/2020 and 2020/2021*. At first glance, the drop could be correlated in the **hard-lockdown** that occurred due to **COVID-19.** Eastern Cape, Gauteng, and Kwazulu-Natal are the three provinces with the highest counts of **rape during this period.**

#### Aggravated Robbery

```{r}
#| eval: true
#| label: fig-agg-robbery-crimes-provincial
#| fig-cap: The trend of aggravated robbery in each province between 2013 and 2023.
# create aggrevated robbery dataframe
robbery_agg_provincial <- filter_df_provincial(df_crime_sa_provincial,robbery_agg_list )

# create aggrevated robbery facet plot
provincial_facet(robbery_agg_provincial,
                 "Aggrevated Robbery Trend between 2013 and 2023 by Province")
```

Figure @fig-agg-robbery-crimes-provincial shows the trend of *aggravated robbery crimes - carjacking and robbery at non-residential and residential premises.* Gauteng has the highest numbers for each crime in this category during this period. We also notice that the increase in **carjacking,** which was mentioned in @fig-robbery_aggrevated_national, predominantly occurs in Gauteng. **Northern Cape,** has the lowest number of aggravated robbery crimes during this period.

### Contact Related Crimes

```{r}
#| eval: true
#| label: fig-contact-related-crimes-provincial
#| fig-cap: The trend of contact-related crimes in each province between 2013 and 2023.
# create provincial contact related crimes dataframe
contact_related_provincial <- filter_df_provincial(df_crime_sa_provincial, contact_related_list)

# create contact related crimes facet plot
provincial_facet(contact_related_provincial, "Contact Related Crime Trend Between 2013 and 2023 by Province")

```

Figure @fig-contact-related-crimes-provincial shows the trend of contact-related crimes - *arson and malicious damage to property.* Malicious damage to property is the more frequent crime and we see the highest rates in - Gauteng, Western Cape, and Kwazulu-Natal.

### Property Related Crimes

```{r}
#| eval: true
#| label: fig-property-related-crimes-provincial
#| fig-cap: The trend of property-related crimes in each province between 2013 and 2023.
# create provincial property related crimes dataframe
property_related_provincial <- filter_df_provincial(df_crime_sa_provincial, property_related_crimes)

# create a property related crimes facet plot
provincial_facet(property_related_provincial, "Property-related Crime Trend between 2013 and 2023 by Province")
```

Figure @fig-property-related-crimes-provincial shows the trend of property-related crimes - burglary *at residential and non-residential premises, stock-theft, theft of motor vehicle and motorcycle, and theft out of or from motor vehicles.* Gauteng has the highest rates during this period. Burglary at residential premises is the most common crime in this category in each of the provinces.

### Other Serious Crimes

```{r}
#| eval: true
#| label: fig-other-serious-crimes-provincial
#| fig-cap: The trend of other serious crimes in each province between 2013 and 2023.
# create provincial dataframe for other serious crimes
serious_crimes_provincial <- filter_df_provincial(df_crime_sa_provincial, serious_crimes_list)

# create other serious crimes facet wrap
provincial_facet(serious_crimes_provincial, "Other Serious Crimes Provincial Trend between 2013 and 2023")
```

Figure @fig-other-serious-crimes-provincial shows the crime trend of crimes - *all theft not mentioned elsewhere, commercial crime, and shoplifting.* Theft is the most frequent crime in this category during this period with Gauteng and Western Cape having the highest numbers.

### Crimes Detected as a Result of Police action

```{r}
#| eval: true
#| label: fig-crimes-police-detected-provincial
#| fig-cap: The trend of crimes detected as a result of police action in each province between 2013 and 2023.
# create a provincial dataframe for the crimes detected as a result of police action
police_detected_provincial <- filter_df_provincial(df_crime_sa_provincial, police_detected_list)

# create a facet plot for the provincial 
provincial_facet(police_detected_provincial, "Provincial Trend of Crimes Detected As A Result of Police Action Between 2013 and 2023")
```

Figure @fig-crimes-police-detected-provincial shows the crime trend of crimes - *driving under the influence, drug-related crimes, illegal possession of firearms and ammunition, and sexual offences detected as a result of police action.* The crimes detected as a result of police action has stayed relatively constant in all the provinces besides Western Cape, Gauteng, and Kwazulu-Natal. We see a reduction in police detecting drug-related crimes in these provinces from 2017/2018.

## Station Crime Trend

The **station level** allows us to see which areas (**police station**) have the highest reported crimes. We can look at it per province or can compile the **top 10 stations** and see which **province** occurs the most.

### Contact Crimes

```{r}
#| label: tbl-contact-station
#| tbl-cap: The top ranking stations in South Africa for contact crimes.
#| 
# create contact crimes dataframe

contact_station10 <- station_crime_rank(df_crime_sa_station,contact_crimes_list,"Contact Crimes", 10)
contact_station10

```

Table @tbl-contact-station shows the top `10` stations with the highest amount of contact crime cases in South Africa between 2013 and 2023. We can see that stations are all from Gauteng, Western Cape, or Kwazulu-Natal. The stations are all based in under-resourced neighbourhoods (townships) which are densely populated. The City of Cape Town District and eThekwini District are the only districts from Western Cape and Kwazulu-Natal, respectively. In Gauteng, Johannesburg District and Tshwane (Pretoria) District make the top 10.

We now look at selected crimes in the contact crimes category.

```         
```

```         
```

```         
```

#### **Murder**

```{r}
#| label: tbl-murder-station
#| tbl-cap: The top ranking stations in South Africa for Murder.
#| 
murder_station10 <- station_crime_rank(df_crime_sa_station,"Murder","Murder", 10)
murder_station10
```

Table @tbl-murder-station shows the stations which had the highest number of reported cases of murder between 2013 and 2023. The City of Cape Town District has been called the murder capital of South Africa. There 7 stations from this district in the top 10 and this is due to the high level of poverty and gangsterism in these under-resourced communities. The remaining three are from Kwazulu-Natal (eThwekini District) with Inanda second on the list.

#### **Sexual Offences**

```{r}
#| label: tbl-sexoffences-station
#| tbl-cap: The stations in South Africa with the most cases for sexual offences.
#| 
sexoffence_station10 <- station_crime_rank(df_crime_sa_station,"Sexual offences","Sexual Offences",10)
sexoffence_station10
```

Table @tbl-sexoffences-station shows the stations that had the highest number of reported cases for sexual offences between 2013 and 2023. Inanda, Kwazulu-Natal has the highest number of cases for sexual offences in this period. Eastern Cape (Lusikisiki and Mthatha) and Limpopo (Thohoyandou) , which have not appeared in the previous tables are included in the top 10.

##### **Robbery with aggravating circumstances**

```{r}
#| label: tbl-rag-station
#| tbl-cap: The stations in South Africa with the most cases for robbery with agrravated circumstances.
#| 
rac_station10 <- station_crime_rank(df_crime_sa_station,"Robbery with aggravating circumstances","Robbery With Aggravating Circumstances",10)
rac_station10
```

Table @tbl-rag-station shows the stations that had the highest number of reported cases for robbery with aggravation circumstances between 2013 and 2023. Johannesburg Central Station had the highest - 15785, in this 10 year period. Johannesburg is in the most densily populated province, Gauteng, and has an increasing population growth due to migrant workers looking for better opportunities in the economic hub of South Africa. The three most densely populated provinces in the country make up this table.

#### **Rape**

```{r}
#| label: tbl-rape-station
#| tbl-cap: The stations in South Africa with the most cases for rape offences.
rape_station10 <- station_crime_rank(df_crime_sa_station,"Rape","Rape",10)
rape_station10
```

Table @tbl-rape-station shows the stations with the highest number of reported rape cases in the country between 2013 and 2023. The stations in this table are similar to that of Table @tbl-sexoffences-station.

#### **Attempted Sexual Offences**

```{r}
#| label: tbl-attsexoffence-station
#| tbl-cap: The stations in South Africa with the most cases for attempted sexual offences.
#| 
att_sexual_offences_station10 <- station_crime_rank(df_crime_sa_station,"Attempted sexual offences","Attempted sexual offences",10)
att_sexual_offences_station10
```

Table @tbl-attsexoffence-station shows the stations with the highest cases of attempted sexual offences in the country between 2013 and 2023. The entries in this table have not featured in the previous tables, and we see a station from Northern Cape in the top four.

### **Property related crimes**

```{r}
#| label: tbl-property-related-station
#| tbl-cap: The stations in South Africa with the most cases for Property-related Crimes.

proprerty_station<- station_crime_rank(df_crime_sa_station,property_related_crimes,"Property Related Crimes",10)
proprerty_station
```

```         
```

#### **Motor vehicle or motorcycle theft**

```{r}
#| label: tbl-vehicle-station
#| tbl-cap: The stations in South Africa with the most cases for vehicle and motorcycle theft.
#| 
vehicle_station10 <- station_crime_rank(df_crime_sa_station,"Theft of motor vehicle and motorcycle","Theft of motor vehicle and motorcycle",10)
vehicle_station10
```

Table @tbl-vehicle-station shows the stations with the highest number of motor vehicle thefts in the country between 2013 and 2023. The table confirms what we saw in @fig-property-related-crimes-provincial, that you're most likely to be a victim of motor theft in Gauteng. There are 8 stations in the top 10 from Gauteng and the remaining 2 from Kwazulu-Natal.

#### **Burglary (Residential)**

```{r}
#| label: tbl-burgres-station
#| tbl-cap: The stations in South Africa with the most cases for burgulary at residential premises.
#| 
burg_res_station10 <- station_crime_rank(df_crime_sa_station,"Burglary at residential premises","Burglary at residential premises",10)
burg_res_station10
```

Table @tbl-burgres-station shows the stations with the highest number of reported cases for burglary at residential premises between 2013 and 2023.

#### **Kidnapping**

```{r}
#| label: tbl-kidnapping-station
#| tbl-cap: The stations in South Africa with the most cases for kidnapping.
#| 
kidnapping_station10 <- station_crime_rank(df_crime_sa_station,"Kidnapping","Kidnapping",10)
kidnapping_station10
```

Table @tbl-kidnapping-station shows the stations with the highest number of kidnapping cases in the country between 2013 and 2023. The top 10 stations are from Gauteng and Kwazulu-Natal with one station from Mpumalanga. Kidnapping in South Africa is a fairly recent trend and according to [Institute For Security Studies](https://issafrica.org/iss-today/to-reduce-kidnappings-south-africas-police-must-tackle-armed-robbery), this crime is four times higher compared to 10 years ago and can be linked to the growth of violent and organised crime in the country.

### Other Serious Crimes

```{r}
#| label: tbl-other-serious-station
#| tbl-cap: The stations in South Africa with the most cases of other serious crimes.

serious_crimes_station<- station_crime_rank(df_crime_sa_station,serious_crimes_list,"Other Serious Crimes",10)
serious_crimes_station
```

```         
```

# Conclusion

In this project, the crime statistics released by the SAPS for 2022/2023 was analysed to determine the state of crime in the country. The following are the findings:

-   The trend of crime in the Republic of South Africa seems to be on the increase according to the crime statistics published by the South African Police Service.

-   There was a reduction in most crimes in the reported year of 2020/2021 - this could be attributed to the COVID-19 restrictions on movement. This would have to be investigated in another study.

-   The highest crime rates can be found in under-resourced areas where there is high unemployment and poverty levels.

-   The trend of contact crimes has been on the increase since 2020/2021.

-   The trend of carkacking in the country has increased by 103% between 2013 and 2023 - with Gauteng being the hub for this crime.

# References

```         
```

```         
```
